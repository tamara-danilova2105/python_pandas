# üìå Pandas –®–ø–∞—Ä–≥–∞–ª–∫–∞ (–æ—Å–Ω–æ–≤—ã)

## üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

``` python
import pandas as pd

df = pd.read_csv("people.csv")       # –∑–∞–≥—Ä—É–∑–∏—Ç—å CSV ‚Üí DataFrame
df.to_csv("people_processed.csv", index=False)  # —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–µ–∑ –∏–Ω–¥–µ–∫—Å–∞
```

------------------------------------------------------------------------

## üîé –ò–∑—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

``` python
df.head()       # –ø–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫
df.tail()       # –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫
df.info()       # —Ç–∏–ø—ã –∫–æ–ª–æ–Ω–æ–∫, –ø—Ä–æ–ø—É—Å–∫–∏
df.describe()   # —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª–æ–≤—ã–º –∫–æ–ª–æ–Ω–∫–∞–º
df.shape        # (—Å—Ç—Ä–æ–∫–∏, –∫–æ–ª–æ–Ω–∫–∏)
df["city"].unique()  # —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

------------------------------------------------------------------------

## üéØ –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º

``` python
df["name"]              # –æ–¥–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ (Series)
df[["name", "city"]]    # –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–ª–æ–Ω–æ–∫
df.loc[0]               # —Å—Ç—Ä–æ–∫–∞ –ø–æ –∏–Ω–¥–µ–∫—Å—É (–º–µ—Ç–∫–∞)
df.iloc[0]              # —Å—Ç—Ä–æ–∫–∞ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ (–Ω–æ–º–µ—Ä)
```

------------------------------------------------------------------------

## üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è

``` python
df[df["age"] >= 30]                  # –≤—Å–µ, –∫—Ç–æ —Å—Ç–∞—Ä—à–µ 30
df[df["city"] == "Moscow"]           # —Ç–æ–ª—å–∫–æ –ú–æ—Å–∫–≤–∞
df[(df["city"] == "Moscow") & (df["age"] > 30)]  # –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π
```

------------------------------------------------------------------------

## ‚ûï –ù–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏

``` python
df["is_adult"] = df["age"] >= 18          # –≤–∑—Ä–æ—Å–ª—ã–π –∏–ª–∏ –Ω–µ—Ç
df["salary_in_k"] = df["salary"] / 1000   # –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ —Ç—ã—Å—è—á–∞—Ö
df["name_length"] = df["name"].str.len()  # –¥–ª–∏–Ω–∞ –∏–º–µ–Ω–∏
```

------------------------------------------------------------------------

## üìù –†–∞–±–æ—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º

``` python
df["name"].str.lower()                   # –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
df["name"].str.contains("a", case=False) # —Å–æ–¥–µ—Ä–∂–∏—Ç –±—É–∫–≤—É "a"
```

------------------------------------------------------------------------

## üìä –ê–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏

``` python
df["age"].mean()             # —Å—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç
df["salary"].max()           # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞
df.groupby("city")["salary"].mean()  # —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º
df.groupby("city").size()    # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π –ø–æ –≥–æ—Ä–æ–¥–∞–º
```

–ù–µ—Å–∫–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∞—Ç–æ–≤:

``` python
df.groupby("city").agg(
    avg_age=("age", "mean"),
    avg_salary=("salary", "mean"),
    adults=("is_adult", "sum")
)
```

------------------------------------------------------------------------

## üìà –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

``` python
df.sort_values("age")                     # —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
df.sort_values("salary", ascending=False) # –ø–æ –∑–∞—Ä–ø–ª–∞—Ç–µ, –ø–æ —É–±—ã–≤–∞–Ω–∏—é
df.sort_values(["city", "age"])           # –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫–æ–ª–æ–Ω–∫–∞–º
```

------------------------------------------------------------------------

## üßπ –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏

``` python
df.dropna()             # —É–±—Ä–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å NaN
df.fillna(0)            # –∑–∞–º–µ–Ω–∏—Ç—å NaN –Ω–∞ 0
```

------------------------------------------------------------------------

## üìå –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –º–µ—Ç–æ–¥—ã

-   `df.head(n)` ‚Üí –ø–µ—Ä–≤—ã–µ n —Å—Ç—Ä–æ–∫\
-   `df.tail(n)` ‚Üí –ø–æ—Å–ª–µ–¥–Ω–∏–µ n —Å—Ç—Ä–æ–∫\
-   `df.info()` ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã\
-   `df.describe()` ‚Üí —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —á–∏—Å–ª–æ–≤—ã–º\
-   `df["col"].value_counts()` ‚Üí –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

------------------------------------------------------------------------

# üöÄ Advanced Pandas

## üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü

``` python
# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É
pd.merge(df1, df2, on="key", how="left")   # left join
pd.merge(df1, df2, on="key", how="inner")  # inner join

# –°–∫–ª–µ–∏–≤–∞–Ω–∏–µ
pd.concat([df1, df2])            # –ø–æ —Å—Ç—Ä–æ–∫–∞–º
pd.concat([df1, df2], axis=1)    # –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
```

------------------------------------------------------------------------

## üìä –°–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (Pivot)

``` python
pd.pivot_table(
    df,
    values="salary",              # —á—Ç–æ —Å—á–∏—Ç–∞–µ–º
    index="region",               # —Å—Ç—Ä–æ–∫–∏
    columns="department_name",    # –∫–æ–ª–æ–Ω–∫–∏
    aggfunc="mean"                # —Ñ—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
)
```

------------------------------------------------------------------------

## üïí –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏

``` python
df["hire_date"] = pd.to_datetime(df["hire_date"])  # —Å—Ç—Ä–æ–∫—É ‚Üí –¥–∞—Ç—É
df["year"] = df["hire_date"].dt.year               # –≥–æ–¥
df["month"] = df["hire_date"].dt.month             # –º–µ—Å—è—Ü
df.groupby("year")["id"].count()                   # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ –≥–æ–¥–∞–º
```

------------------------------------------------------------------------

## üìå –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã

-   `df.query("age > 30 and city == 'Moscow'")` --- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑
    —Å—Ç—Ä–æ–∫—É\
-   `df.apply(func, axis=1)` --- –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫ —Å—Ç—Ä–æ–∫–∞–º\
-   `df["col"].map(func)` --- –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–ª–æ–Ω–∫–∏\
-   `df.value_counts()` --- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π


------------------------------------------------------------------------

# üßπ Data Cleaning (–£—Ä–æ–∫ 3)

## –ü—Ä–æ–ø—É—Å–∫–∏ (NaN)

``` python
df.isna().sum()                        # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
df["age"].fillna(df["age"].mean())     # –∑–∞–º–µ–Ω–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–º
df["salary"].fillna(df["salary"].median())  # –∑–∞–º–µ–Ω–∏—Ç—å –º–µ–¥–∏–∞–Ω–æ–π
df.dropna()                            # —É–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å NaN
```

------------------------------------------------------------------------

## –î—É–±–ª–∏–∫–∞—Ç—ã

``` python
df.duplicated()              # –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
df.drop_duplicates()         # —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
```

------------------------------------------------------------------------

## –ê–Ω–æ–º–∞–ª–∏–∏ (–≤—ã–±—Ä–æ—Å—ã)

``` python
df.describe()                 # –∏—â–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
df = df[(df["age"] >= 0) & (df["salary"] >= 10000)]  # —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```

------------------------------------------------------------------------

## –†–∞–±–æ—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º

``` python
df["name"] = df["name"].str.strip()     # —É–±—Ä–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã
df["name"] = df["name"].str.lower()     # –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
```

------------------------------------------------------------------------

## –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤

``` python
df["age"] = df["age"].astype(int)       
df["hire_date"] = pd.to_datetime(df["hire_date"])  # —Å—Ç—Ä–æ–∫—É ‚Üí –¥–∞—Ç—É
df["year"] = df["hire_date"].dt.year
```

------------------------------------------------------------------------

# üõ† Feature Engineering (–£—Ä–æ–∫ 3)

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞

``` python
bins = [0, 25, 40, 100]
labels = ["–º–æ–ª–æ–¥–æ–π", "—Å—Ä–µ–¥–Ω–∏–π", "—Å—Ç–∞—Ä—à–∏–π"]
df["age_group"] = pd.cut(df["age"], bins=bins, labels=labels, right=False)
```

------------------------------------------------------------------------

## –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã

``` python
import numpy as np

conditions = [
    (df["salary"] < 70000),
    (df["salary"].between(70000, 100000)),
    (df["salary"] > 100000)
]
choices = ["–Ω–∏–∑–∫–∞—è", "—Å—Ä–µ–¥–Ω—è—è", "–≤—ã—Å–æ–∫–∞—è"]
df["salary_level"] = np.select(conditions, choices, default="–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")
```

------------------------------------------------------------------------

## –î–ª–∏–Ω–∞ –∏–º–µ–Ω–∏

``` python
df["name_length"] = df["name"].str.len()
```

------------------------------------------------------------------------

## –§–ª–∞–≥ –Ω–æ–≤–∏—á–∫–∞ (–ø–æ –≥–æ–¥—É –Ω–∞–π–º–∞)

``` python
df["is_newcomer"] = df["year"] >= 2020
```

------------------------------------------------------------------------
