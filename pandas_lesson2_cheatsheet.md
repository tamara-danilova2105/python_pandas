# üöÄ Advanced Pandas

## üîó –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü

``` python
# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ –∫–ª—é—á—É
pd.merge(df1, df2, on="key", how="left")   # left join
pd.merge(df1, df2, on="key", how="inner")  # inner join

# –°–∫–ª–µ–∏–≤–∞–Ω–∏–µ
pd.concat([df1, df2])            # –ø–æ —Å—Ç—Ä–æ–∫–∞–º
pd.concat([df1, df2], axis=1)    # –ø–æ –∫–æ–ª–æ–Ω–∫–∞–º
```

------------------------------------------------------------------------

## üìä –°–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (Pivot)

``` python
pd.pivot_table(
    df,
    values="salary",              # —á—Ç–æ —Å—á–∏—Ç–∞–µ–º
    index="region",               # —Å—Ç—Ä–æ–∫–∏
    columns="department_name",    # –∫–æ–ª–æ–Ω–∫–∏
    aggfunc="mean"                # —Ñ—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
)
```

------------------------------------------------------------------------

## üïí –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏

``` python
df["hire_date"] = pd.to_datetime(df["hire_date"])  # —Å—Ç—Ä–æ–∫—É ‚Üí –¥–∞—Ç—É
df["year"] = df["hire_date"].dt.year               # –≥–æ–¥
df["month"] = df["hire_date"].dt.month             # –º–µ—Å—è—Ü
df.groupby("year")["id"].count()                   # –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ –≥–æ–¥–∞–º
```

------------------------------------------------------------------------

## üìå –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã

-   `df.query("age > 30 and city == 'Moscow'")` --- —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑
    —Å—Ç—Ä–æ–∫—É\
-   `df.apply(func, axis=1)` --- –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫ —Å—Ç—Ä–æ–∫–∞–º\
-   `df["col"].map(func)` --- –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –∫–æ–ª–æ–Ω–∫–∏\
-   `df.value_counts()` --- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
